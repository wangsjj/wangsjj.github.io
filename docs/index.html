<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>ä¸ªäººä¿¡æ¯ç”Ÿæˆå™¨</title>
    <link href="css.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" rel="stylesheet">
    <script type="text/javascript" src="person.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        .container {
            margin: 0 auto;
            background: #ffffff;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(50, 50, 93, 0.1), 0 5px 15px rgba(0, 0, 0, 0.07);
        }
        
        h1 {
            text-align: center;
            color: #1a237e;
            margin-bottom: 40px;
            font-size: 2.8em;
            font-weight: 700;
            letter-spacing: -1px;
            animation: bounceIn 1.2s;
        }

        .btn-container {
            text-align: center;
            margin: 40px 0;
            animation: slideInUp 0.8s;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: #6200ea;
            color: white;
            border: none;
            padding: 18px 50px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.3em;
            font-weight: 600;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 20px rgba(98, 0, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(98, 0, 234, 0.4);
            background: #7c4dff;
        }

        .btn:active {
            transform: translateY(1px);
            box-shadow: 0 4px 15px rgba(98, 0, 234, 0.2);
        }

        .btn-export {
            background: #00c853;
            box-shadow: 0 4px 20px rgba(0, 200, 83, 0.3);
        }

        .btn-export:hover {
            background: #00e676;
            box-shadow: 0 8px 25px rgba(0, 200, 83, 0.4);
        }

        .btn-clear {
            background: #ff5252;
            box-shadow: 0 4px 20px rgba(255, 82, 82, 0.3);
        }

        .btn-clear:hover {
            background: #ff6b6b;
            box-shadow: 0 8px 25px rgba(255, 82, 82, 0.4);
        }

        table {
            animation: fadeInUp 1s;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        th {
            font-size: 1.15em;
            padding: 22px 18px;
            background: #f5f5ff;
            color: #303f9f;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        td {
            font-size: 1.05em;
            padding: 18px;
            color: #37474f;
            border-bottom: 1px solid #e8eaf6;
        }

        tbody tr {
            transition: all 0.4s ease;
            background: #ffffff;
        }

        tbody tr:hover {
            background-color: #f8f9ff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .btn-delete-row {
            background: #ff5252;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-delete-row:hover {
            background: #ff6b6b;
            transform: scale(1.05);
        }

        .note-input {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e8eaf6;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .note-input:focus {
            outline: none;
            border-color: #6200ea;
        }

        body {
            background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%);
            min-height: 100vh;
            padding: 40px 20px;
            transition: filter 0.3s ease;
        }

        body.dark-mode {
            filter: brightness(0.7);
        }

        .light-switch {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #fff;
            border: 2px solid #6200ea;
            color: #6200ea;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .light-switch:hover {
            background: #6200ea;
            color: #fff;
        }
    </style>
    <script>
        function showFireworks() {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.3 },
                gravity: 1.2,
                scalar: 0.8,
                startVelocity: 30,
                ticks: 200
            });
        }
        
        function generateWithFireworks() {
            showFireworks();
            randomPerson();
        }

        function toggleLight() {
            document.body.classList.toggle('dark-mode');
            const button = document.querySelector('.light-switch');
            if (document.body.classList.contains('dark-mode')) {
                button.textContent = 'å¼€ç¯';
            } else {
                button.textContent = 'å…³ç¯';
            }
        }

        function exportToExcel() {
            const table = document.getElementById('table');
            const tbody = table.querySelector('tbody');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®
            if (tbody.rows.length === 0) {
                alert('è¯·å…ˆç”Ÿæˆæ•°æ®å†å¯¼å‡ºï¼');
                return;
            }
            
            // æ”¶é›†è¡¨æ ¼æ•°æ®
            const data = [];
            
            // æ·»åŠ è¡¨å¤´
            const headers = [];
            const headerCells = table.querySelectorAll('thead th');
            headerCells.forEach(cell => {
                headers.push(cell.textContent);
            });
            data.push(headers);
            
            // æ·»åŠ æ•°æ®è¡Œ
            const rows = tbody.querySelectorAll('tr');
            rows.forEach(row => {
                const rowData = [];
                const cells = row.querySelectorAll('td');
                cells.forEach((cell, index) => {
                    // å¯¹äºå¤‡æ³¨åˆ—ï¼ˆæœ€åä¸€åˆ—ï¼‰ï¼Œè·å–inputçš„å€¼
                    if (index === cells.length - 1) {
                        const input = cell.querySelector('input');
                        rowData.push(input ? input.value : '');
                    } else {
                        rowData.push(cell.textContent);
                    }
                });
                data.push(rowData);
            });
            
            // åˆ›å»ºå·¥ä½œç°¿
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // è®¾ç½®åˆ—å®½
            const colWidths = [
                { wch: 10 },  // å§“å
                { wch: 20 },  // èº«ä»½è¯å·
                { wch: 15 },  // æ‰‹æœºå·
                { wch: 20 },  // é“¶è¡Œå¡å·
                { wch: 12 },  // è½¦ç‰Œå·
                { wch: 12 },  // è½¦æ¶å·
                { wch: 30 },  // åœ°å€
                { wch: 15 }   // å¤‡æ³¨
            ];
            ws['!cols'] = colWidths;
            
            // æ·»åŠ å·¥ä½œè¡¨åˆ°å·¥ä½œç°¿
            XLSX.utils.book_append_sheet(wb, ws, 'ä¸ªäººä¿¡æ¯');
            
            // ç”Ÿæˆæ–‡ä»¶åï¼ˆä½¿ç”¨å½“å‰æ—¥æœŸæ—¶é—´ï¼‰
            const now = new Date();
            const filename = `ä¸ªäººä¿¡æ¯_${now.getFullYear()}${(now.getMonth()+1).toString().padStart(2,'0')}${now.getDate().toString().padStart(2,'0')}_${now.getHours().toString().padStart(2,'0')}${now.getMinutes().toString().padStart(2,'0')}${now.getSeconds().toString().padStart(2,'0')}.xlsx`;
            
            // å¯¼å‡ºæ–‡ä»¶
            XLSX.writeFile(wb, filename);
            
            // æ˜¾ç¤ºæˆåŠŸæç¤ºå’ŒçƒŸèŠ±æ•ˆæœ
            confetti({
                particleCount: 150,
                spread: 80,
                origin: { y: 0.5 },
                colors: ['#00c853', '#00e676', '#69f0ae']
            });
        }
    </script>
</head>
<body>
    <button class="light-switch" onclick="toggleLight()">å…³ç¯</button>
    <div class="container">
        <div class="btn-container">
            <button class="btn" onclick="generateWithFireworks()">
                <span>ç”Ÿæˆä¿¡æ¯</span>
            </button>
            <button class="btn btn-export" onclick="exportToExcel()">
                <span>ğŸ“¥ å¯¼å‡ºåˆ°Excel</span>
            </button>
            <button class="btn btn-clear" onclick="clearAllData()">
                <span>ğŸ—‘ï¸ æ¸…ç©ºæ•°æ®</span>
            </button>
        </div>
        <table id="table">
            <thead>
                <tr>
                    <th>å§“å</th>
                    <th>èº«ä»½è¯å·</th>
                    <th>æ‰‹æœºå·</th>
                    <th>é“¶è¡Œå¡å·</th>
                    <th>è½¦ç‰Œå·</th>
                    <th>è½¦æ¶å·</th>
                    <th>åœ°å€</th>
                    <th>å¤‡æ³¨</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                <!-- æ•°æ®è¡Œå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </tbody>
        </table>
    </div>
</body>
</html>
